<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>التوأم الرقمي — مدينة عَنّة</title>

    <!-- ArcGIS JS API -->
    <link rel="stylesheet" href="https://js.arcgis.com/4.30/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.30/"></script>

    <style>
      html, body, #viewDiv {
        padding: 0; margin: 0;
        height: 100%; width: 100%;
        overflow: hidden;
        font-family: "Segoe UI", Tahoma, Arial;
      }
      .toolbar {
        position: absolute;
        top: 15px; right: 15px;
        z-index: 10;
        display: flex; gap: 10px;
      }
      .btn {
        background:#ffffff;
        padding:8px 14px;
        border:1px solid #ddd;
        border-radius:10px;
        cursor:pointer;
        box-shadow:0 2px 8px rgba(0,0,0,.1);
      }
    </style>
  </head>

  <body>
    <div id="viewDiv"></div>

    <div class="toolbar">
      <button id="btnReset" class="btn">إعادة تموضع</button>
      <button id="btnToggle" class="btn">إخفاء / إظهار المباني</button>
    </div>

    <script>
      require([
        "esri/Map",
        "esri/views/SceneView",
        "esri/layers/SceneLayer"
      ], function(Map, SceneView, SceneLayer) {

        // 1) طبقة الـ SLPK
        const sceneLayer = new SceneLayer({
          url: "/assets/city3d/anahcityscenes01.slpk" // <-- ضع هنا المسار الصحيح
        });

        // 2) إعداد الخريطة
        const map = new Map({
          basemap: "satellite",
          ground: "world-elevation",
          layers: [sceneLayer]
        });

        // 3) إعداد المشهد الثلاثي
        const view = new SceneView({
          container: "viewDiv",
          map: map,
          environment: {
            background: { type: "color", color: "#0b1020" },
            starsEnabled: false,
            atmosphereEnabled: true
          },
          camera: {
            position: {
              longitude: 41.9866,   // إحداثيات عَنّة
              latitude: 34.3758,
              z: 800
            },
            tilt: 60
          }
        });

        // 4) زر إعادة التموضع
        document.getElementById("btnReset").onclick = () => {
          view.goTo({
            position: {
              longitude: 41.9866,
              latitude: 34.3758,
              z: 800
            },
            tilt: 60
          });
        };

        // 5) زر إخفاء / إظهار الطبقة
        document.getElementById("btnToggle").onclick = () => {
          sceneLayer.visible = !sceneLayer.visible;
        };

      });
    </script>
  </body>
</html>
