<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>Ø§Ù„ØªÙˆØ£Ù… Ø§Ù„Ø±Ù‚Ù…ÙŠ â€” Ù…Ø¯ÙŠÙ†Ø© Ø¹ÙÙ†Ù‘Ø© Ø§Ù„Ø°ÙƒÙŠØ©</title>

  <!-- ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Cesium -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cesium/1.114/Cesium.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/cesium/1.114/Widgets/widgets.css" rel="stylesheet"/>

  <style>
    html, body, #cesiumContainer {
      width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
    }

    .toolbar {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 999;
      background: white;
      padding: 10px 14px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      font-family: sans-serif;
    }

    .toolbar button {
      margin-bottom: 6px;
      width: 120px;
      padding: 7px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>

<body>

<div id="cesiumContainer"></div>

<div class="toolbar">
  <button onclick="toggleRoads()">Ø¥Ø¸Ù‡Ø§Ø± / Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø·Ø±Ù‚</button><br>
  <button onclick="resetView()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø±ÙƒØ²</button>
</div>

<script>
  // Ù…ÙØªØ§Ø­ Bing Maps (Ù…ÙØªØ§Ø­ Ø¹Ø§Ù… Ù…Ø¬Ø§Ù†ÙŠ Ù…Ù† Cesium)
  Cesium.Ion.defaultAccessToken = '';

  const viewer = new Cesium.Viewer("cesiumContainer", {
    terrain: Cesium.Terrain.fromWorldTerrain(),
    imageryProvider: new Cesium.IonImageryProvider({ assetId: 3 }), // Bing Aerial
    baseLayerPicker: false,
    geocoder: false,
    homeButton: false,
    navigationHelpButton: false,
    sceneModePicker: false,
    timeline: false,
    animation: false
  });

  // ============================================================
  // ğŸ¯ ØªØ­Ù…ÙŠÙ„ Ø·Ø¨Ù‚Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ (SLPK)
  // ============================================================
  const buildingsTileset = viewer.scene.primitives.add(
    new Cesium.Cesium3DTileset({
      url:
"https://rawcdn.githack.com/husseinsmart-droid/smart-anah-site/47d2d766445b249384b530510e1bb80e25a874a6/assets/digital-twin/anah_buildings02.slpk"
    })
  );

  buildingsTileset.readyPromise.then(() => {
    console.log("âœ” ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ");
  });

  // ============================================================
  // ğŸ¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ø±Ù‚ (GeoJSON)
  // ============================================================
  let roadsLayer;

  Cesium.GeoJsonDataSource.load(
    "https://raw.githubusercontent.com/husseinsmart-droid/smart-anah-site/main/assets/digital-twin/Roads02.geojson",
    {
      clampToGround: true,
      stroke: Cesium.Color.YELLOW,
      strokeWidth: 2
    }
  ).then((ds) => {
    roadsLayer = ds;
    viewer.dataSources.add(ds);
    console.log("âœ” ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø±Ù‚");
  }).catch(err => {
    console.error("Ø®Ø·Ø£ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ø±Ù‚:", err);
  });

  // ============================================================
  // ğŸ¯ Ø¯Ø§Ù„Ø© Ø¥Ø¸Ù‡Ø§Ø± ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ø·Ø±Ù‚
  // ============================================================
  function toggleRoads() {
    if (roadsLayer) {
      roadsLayer.show = !roadsLayer.show;
    }
  }

  // ============================================================
  // ğŸ¯ Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø±ÙƒØ² Ø¹Ù„Ù‰ Ù…Ø¯ÙŠÙ†Ø© Ø¹ÙÙ†Ù‘Ø©
  // ============================================================
  function resetView() {
    viewer.camera.flyTo({
      destination: Cesium.Cartesian3.fromDegrees(41.9815, 34.4690, 2500),
      orientation: {
        heading: Cesium.Math.toRadians(0),
        pitch: Cesium.Math.toRadians(-45),
        roll: 0
      }
    });
  }

  // ØªØ´ØºÙŠÙ„Ù‡Ø§ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
  setTimeout(resetView, 2000);

</script>

</body>
</html>
