<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Digital Twin - Anah Smart City</title>

    <script src="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Widgets/widgets.css" rel="stylesheet">

    <style>
        html, body, #cesiumContainer {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>

<div id="cesiumContainer"></div>

<script>
// -----------------------
// إعداد المشهد الأساسي
// -----------------------
const viewer = new Cesium.Viewer("cesiumContainer", {
    terrainProvider: Cesium.createWorldTerrain(),
    animation: false,
    timeline: false,
    baseLayerPicker: true,
    sceneMode: Cesium.SceneMode.SCENE3D
});

// ------------------------------
// 1) طبقة الطرق (GeoJSON)
// ------------------------------
Cesium.GeoJsonDataSource.load(
    "https://raw.githubusercontent.com/husseinsmart-droid/smart-anah-site/main/assets/digital-twin/Roads02.geojson",
    {
        stroke: Cesium.Color.YELLOW,
        fill: Cesium.Color.YELLOW,
        strokeWidth: 2,
        clampToGround: true
    }
).then(function(dataSource) {
    viewer.dataSources.add(dataSource);
    console.log("Roads layer loaded");
}).catch(function(error) {
    console.error("Error loading Roads layer:", error);
});

// ------------------------------
// 2) طبقة المباني (SLPK)
// ------------------------------
const buildingsLayer = new Cesium.Cesium3DTileset({
    url: "https://raw.githubusercontent.com/husseinsmart-droid/smart-anah-site/main/assets/digital-twin/anah_buildings02.slpk"
});

viewer.scene.primitives.add(buildingsLayer);

buildingsLayer.readyPromise.then(() => {
    console.log("Buildings SLPK loaded successfully");

    // تحريك الكاميرا تلقائياً عند تحميل المباني
    viewer.zoomTo(buildingsLayer);
}).catch((error) => {
    console.error("Error loading buildings SLPK:", error);
});

// ------------------------------
// 3) تحسين الإضاءة والظلال
// ------------------------------
viewer.scene.globe.enableLighting = true;
viewer.shadows = true;

</script>

</body>
</html>
